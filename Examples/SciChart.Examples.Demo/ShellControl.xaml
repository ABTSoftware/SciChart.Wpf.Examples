<UserControl x:Class="SciChart.Examples.Demo.ShellControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:abt="http://schemas.abtsoftware.co.uk/presentation"
             xmlns:behaviors="clr-namespace:SciChart.Examples.Demo.Behaviors"
             xmlns:converters="clr-namespace:SciChart.Examples.Demo.Common.Converters"
             xmlns:ext="http://schemas.abtsoftware.co.uk/scichart/exampleExternals"
             xmlns:helpers="clr-namespace:SciChart.Examples.Demo.Helpers"
             xmlns:s="http://schemas.abtsoftware.co.uk/scichart"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:navigation="clr-namespace:SciChart.Examples.Demo.Helpers.Navigation"
             xmlns:views="clr-namespace:SciChart.Examples.Demo.Views"
             xmlns:w="clr-namespace:SciChart.Examples.Demo.Controls.WatermarkedAutocomplete"
             xmlns:tz="http://schemas.abtsoftware.co.uk/transitionz">

    <UserControl.Resources>

        <s:BooleanToVisibilityConverter x:Key="b2vConverter"/>
        <ext:BoolToValueConverter x:Key="BoolToValueConverter" FalseValue="Collapsed" TrueValue="Visible" />

        <converters:IsEmptyStringConverter x:Key="IsEmptyStringConverter" />
        <converters:StringToOpacityConverter x:Key="StringToOpacityConverter" InverseOpacityValue="True"/>

        <DataTemplate x:Key="WatermarkContentTemplate">
            <DockPanel Margin="5,0"
                       HorizontalAlignment="Left"
                       IsHitTestVisible="False">

                <Path x:Name="PART_SearchIcon"
                      DockPanel.Dock="Left"
                      Stretch="Uniform"
                      Width="16"
                      Height="16"
                      VerticalAlignment="Center" 
                      Data="m 28 27 -7.5 -7.5 c 1.1 -1.7 1.8 -3.8 1.8 -6 0 -6.1 -5 -11.1 -11.1 -11.1 -6.1 0 -11.1 5 -11.1 11.1 0 6.1 4.9 11.2 11 11.2 3 0 5.6 -1.2 7.6 -3.1 l 7.3 7.3 c 0.3 0.3 0.6 0.4 1 0.4 0.3 0 0.7 -0.1 1 -0.4 0.5 -0.5 0.5 -1.3 0 -1.9 z m -16.9 -5 c -4.6 0 -8.4 -3.8 -8.4 -8.4 0 -4.6 3.8 -8.4 8.4 -8.4 4.6 0 8.4 3.8 8.4 8.4 0 4.6 -3.8 8.4 -8.4 8.4 z"
                      Fill="{DynamicResource SearchBoxWatermarkForegroundBrush}" />

                <TextBlock x:Name="PART_Watermark"
                           Margin="10,0,0,0"
                           HorizontalAlignment="Left"
                           VerticalAlignment="Center"
                           FontFamily="Segoe UI"
                           FontSize="14"
                           Foreground="{DynamicResource SearchBoxWatermarkForegroundBrush}"
                           TextTrimming="CharacterEllipsis"
                           Text="Search Examples, Source Code and more..." />
            </DockPanel>
        </DataTemplate>

    </UserControl.Resources>

    <Grid x:Name="LayoutRoot"
          Background="{DynamicResource ApplicationBackgroundBrush}"
          Visibility="{Binding InitReady, Converter={StaticResource b2vConverter}, FallbackValue=Collapsed}">

        <Grid.RowDefinitions>
            <RowDefinition Height="86" />
            <RowDefinition Height="*" />
            <RowDefinition Height="30" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="20,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0"
                    Command="{Binding GoBackCommand}"
                    Style="{StaticResource BackButtonStyle}" />

            <Button Grid.Column="1"
                    Margin="10,0"
                    AutomationProperties.AutomationId="ShellControl.Home"
                    Command="{Binding NavigateToHomeCommand}"
                    Style="{StaticResource HomeButtonStyle}" />

            <Button Grid.Column="2"
                    Command="{Binding GoForwardCommand}"
                    Style="{StaticResource NextButtonStyle}" />

            <Canvas Grid.Column="3"
                    Height="46"
                    Width="180"
                    Margin="10,0,0,0"
                    ClipToBounds="True"
                    Background="Transparent"
                    MouseDown="OnSciChartLogoMouseDown"
                    ToolTip="SciChart | Making Impossible Projects Possible since 2012"
                    Cursor="Hand">

                <ContentPresenter Height="60"
                                  Canvas.Left="0"
                                  Canvas.Top="-6"
                                  IsHitTestVisible="False"
                                  Content="{StaticResource SciChartColoredLogoImage}"/>
            </Canvas>

            <Border x:Name="SearchBoxWrapper" Grid.Column="4" Margin="10,0">
                <w:WatermarkedAutocomplete x:Name="SearchBox"
                                           Height="48"
                                           Width="400"
                                           HorizontalAlignment="Right"
                                           VerticalAlignment="Center"
                                           FontSize="18"
                                           IsEnabled="{Binding SearchBoxEnabled, Mode=TwoWay}"
                                           ItemsSource="{Binding AutoCompleteDataSource}"
                                           Text="{Binding SearchText, Mode=TwoWay}"
                                           behaviors:AutocompleteHelper.LoseFocusOnEscape="False"
                                           behaviors:AutocompleteHelper.WatermarkContentTemplate="{StaticResource WatermarkContentTemplate}">
                    <i:Interaction.Behaviors>
                        <behaviors:ExampleAutocompleteBehavior/>
                    </i:Interaction.Behaviors>
                </w:WatermarkedAutocomplete>
            </Border>

            <Button Grid.Column="5"
                    Name="SettingsButton"
                    Margin="10,0,0,0"
                    AutomationProperties.AutomationId="ShellControl.ShowSettings"
                    Command="{Binding ShowSettingsCommand}"
                    Style="{StaticResource SettingsButtonStyle}" />
        </Grid>

        <abt:ExceptionViewer Grid.Row="0"
                             Grid.RowSpan="2"
                             Margin="10"
                             VerticalAlignment="Top"
                             Panel.ZIndex="9999"
                             Exception="{Binding Exception}" />

        <helpers:TransitioningFrame x:Name="transitionFrame"
                                    Grid.Row="1"
                                    Opacity="{Binding SearchText, Mode=OneWay, Converter={StaticResource StringToOpacityConverter}}"
                                    Style="{StaticResource transitioningFrameStyle}"
                                    tz:Transitionz.Blur="{Binding BlurOnSearchParams}"
                                    navigation:Navigator.StartPage="{Binding HomePage, Mode=OneTime}" />

        <Border Grid.Row="1"
                Opacity="0"
                Background="Transparent"
                tz:Transitionz.Opacity="{tz:OpacityParams From=0, To=1, Duration=200, TransitionOn=Visibility}"
                tz:Transitionz.Visibility="{Binding SearchText, Converter={StaticResource IsEmptyStringConverter}, FallbackValue='Collapsed'}">

            <views:SearchView HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

        </Border>

        <Border Grid.Row="0"
                Grid.RowSpan="2"
                Opacity="0"
                Background="{DynamicResource MetroWindowDialogViewBackgroundBrush}"
                tz:Transitionz.Blur="{Binding Path=BlurBackgroundParams}"
                tz:Transitionz.Opacity="{tz:OpacityParams From=0, To=1, Duration=200, TransitionOn=Visibility}"
                tz:Transitionz.Visibility="{Binding IsSettingsShow, Converter={StaticResource BoolToValueConverter}, FallbackValue=Collapsed}">

            <views:SettingsView HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

        </Border>

        <Border Grid.Row="2" Background="{DynamicResource MetroWindowHeaderBrush}">
            <Grid Margin="10,0" DataContext="{Binding Source={x:Static ext:FeaturesHelper.Instance}}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           HorizontalAlignment="Left"
                           VerticalAlignment="Center"
                           ToolTipService.ToolTip="SciChart will use DirectX 10/11 Hardware Acceleration."
                           Visibility="{Binding Path=SupportsHardwareAcceleration, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Run Text="DirectX Hardware Acceleration is" Foreground="{DynamicResource MetroWindowTitleBrush}" />
                    <Run Text="Enabled" Foreground="{DynamicResource HyperlinkForegroundBrush}" />
                </TextBlock>

                <TextBlock Grid.Column="1"
                           HorizontalAlignment="Left"
                           VerticalAlignment="Center"
                           ToolTipService.ToolTip="DirectX Hardware acceleration for 2D Charts is only available on DirectX10 or later GPUs."
                           Visibility="{Binding Path=SupportsHardwareAcceleration, Mode=OneWay, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                    <Run Text="DirectX Hardware Acceleration is" Foreground="{DynamicResource MetroWindowTitleBrush}" />
                    <Run Text="Not Available" Foreground="{DynamicResource HyperlinkForegroundBrush}" />
                </TextBlock>

                <TextBlock Grid.Column="1"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Center"
                           ToolTipService.ToolTip="We recommend viewing our demos with Windows High Performance power plan. You can change the plan in the control panel.">
                    <Run Text="Power Saving Settings:" Foreground="{DynamicResource MetroWindowTitleBrush}" />
                    <Hyperlink Foreground="{DynamicResource HyperlinkForegroundBrush}" Command="{Binding Path=OpenControlPanelCommand}">
                        <Run Text="{Binding CurrentPowerPlanName, Mode=OneWay}" />
                    </Hyperlink>
                </TextBlock>
            </Grid>
        </Border>
    </Grid>
</UserControl>